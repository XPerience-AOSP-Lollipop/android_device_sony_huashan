From 9bec2b36aac1399b67f09fc32dad06751f20fe52 Mon Sep 17 00:00:00 2001
From: bagyusz <phelyx92@gmail.com>
Date: Thu, 19 Jun 2014 22:04:44 +0200
Subject: [PATCH] [PATCH] build: Add SKIP_SET_METADATA flag

    On some of the older devices the recovery doesn't support
    metadata when setting permissions. This allows to use
    set_perm vs set_metadata.
    Enable this behavior by setting SKIP_SET_METADATA := true

Change-Id: Ibf94f593cde287629c85745c72cb358e28700654
Signed-off-by: bagyusz <phelyx92@gmail.com>
---
 core/Makefile | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/core/Makefile b/core/Makefile
index 4c6d26d..0d66cea 100644
--- a/core/Makefile
+++ b/core/Makefile
@@ -1388,7 +1388,9 @@ ifdef PRODUCT_EXTRA_RECOVERY_KEYS
 	$(hide) echo "extra_recovery_keys=$(PRODUCT_EXTRA_RECOVERY_KEYS)" >> $(zip_root)/META/misc_info.txt
 endif
 	$(hide) echo "mkbootimg_args=$(BOARD_MKBOOTIMG_ARGS)" >> $(zip_root)/META/misc_info.txt
+ifneq ($(SKIP_SET_METADATA),true)
 	$(hide) echo "use_set_metadata=1" >> $(zip_root)/META/misc_info.txt
+endif
 	$(hide) echo "multistage_support=1" >> $(zip_root)/META/misc_info.txt
 	$(hide) echo "update_rename_support=1" >> $(zip_root)/META/misc_info.txt
 	$(call generate-userimage-prop-dictionary, $(zip_root)/META/misc_info.txt)
-- 
1.9.2

